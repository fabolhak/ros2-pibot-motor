name: ros2-pibot-motor-fabolhak
version: '0.1'
summary: ROS2 Motor module for my PiBot
description: |
  This package provides the hardware driver to the PiBots motor.

confinement: devmode
base: core18

parts:

  ros2-motor-driver:
    plugin: colcon
    source: .
    source-branch: gpio
    colcon-rosdistro: dashing
    colcon-source-space: pibot_motor
    stage-packages: [ros-dashing-ros-core,libblas3,liblapack3]
    override-prime: | 
      snapcraftctl prime
      ln -s blas/libblas.so.3 libblas.so.3
      cd $SNAPCRAFT_PRIME/usr/lib/$SNAPCRAFT_ARCH_TRIPLET
      ln -s lapack/liblapack.so.3 liblapack.so.3
      
  gpio-lib:
    plugin: python
    python-version: python3
    python-packages: [RPi.GPIO]




apps:
  run:
    command: opt/ros/dashing/bin/ros2 run ros2_pibot_motor service
    plugs:
       - network
       - network-bind
       - gpio
       - gpio-memory-control
       - hardware-observe

architectures:
  - build-on: arm64
